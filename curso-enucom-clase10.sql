--relaciones BD
/*
PADRE->ID, NOMBRE, APP, APM, TRABAJO
HIJO-> ID, NOMBRE, APP, APM, HOBBIE, PADRE_ID
*/

CREATE TABLE PADRE18(
    ID NUMBER PRIMARY KEY,
    NOMBRE NVARCHAR2(100),
    APP NVARCHAR2(100),
    APM NVARCHAR2(100),
    TRABAJO NVARCHAR2(100)
);


CREATE TABLE HIJO18(
    ID NUMBER PRIMARY KEY,
    NOMBRE NVARCHAR2(100),
    APP NVARCHAR2(100),
    APM NVARCHAR2(100),
    HOBBIE NVARCHAR2(100),
    PADRE_ID NUMBER,
    --RELACIONES
    --1RA FORMA
    CONSTRAINT FK_PADRE FOREIGN KEY (PADRE_ID) REFERENCES PADRE18(ID)
    --2DA FORMA
    --FOREIGN KEY (PADRE_ID) REFERENCES PADRE18(ID_PADRE)
);
DROP TABLE HIJO18;

INSERT INTO PADRE18 VALUES(1,'Goku','Son','Kakaroto', 'Luchador');
INSERT INTO PADRE18 VALUES(2,'Homero','Simpson','Lopez', 'Obrero');
INSERT INTO PADRE18 VALUES(3,'Naruto','Usumaki','Deberas', 'Ninja');
INSERT INTO PADRE18 VALUES(4,'Don','Ramon','Monchito', 'Churrero');

SELECT * FROM PADRE18;

--HIJOS
INSERT INTO HIJO18 VALUES(1,'Gohan','Son','Occsatan', 'Estudiar', 1);
INSERT INTO HIJO18 VALUES(2,'Goten','Son','Occsatan', 'Estudiar', 1);
INSERT INTO HIJO18 VALUES(3,'Bartolomeo','Simpson','March', 'Patineta', 2);
INSERT INTO HIJO18 VALUES(4,'Lisa','Simpson','March', 'Saxsofon', 2);
INSERT INTO HIJO18 VALUES(5,'Magi','Simpson','March', 'Patineta',2);
INSERT INTO HIJO18 VALUES(6,'Boruto','Usumaki','Hiuga', 'Entrenar',3);
INSERT INTO HIJO18 VALUES(7,'Himawari','Usumaki','Hiuga', 'Entrenar',3);
INSERT INTO HIJO18 VALUES(8,'Chavo','Del','Ocho', 'Comer',null);

SELECT * FROM HIJO18;

-- EJEMPLOS CON INNER JOIN
-- mostrar los hijos y el nombre del padre
SELECT * 
FROM HIJO18
INNER JOIN PADRE18
ON HIJO18.PADRE_ID = PADRE18.ID
ORDER BY HIJO18.ID;



-- mostrar los hijos y el nombre del padre CON ALIAS EN EL SQL
SELECT H.*, P.*
FROM HIJO18 H
INNER JOIN PADRE18 P
ON H.PADRE_ID = P.ID
ORDER BY H.ID;

-- left join

SELECT H.*, P.*
FROM HIJO18 H
LEFT JOIN PADRE18 P
ON H.PADRE_ID = P.ID
ORDER BY H.ID;


-- RIGHT join

SELECT H.*, P.*
FROM HIJO18 H
RIGHT JOIN PADRE18 P
ON H.PADRE_ID = P.ID
ORDER BY H.ID;

-- full join
SELECT H.*, P.*
FROM HIJO18 H
FULL JOIN PADRE18 P
ON H.PADRE_ID = P.ID
ORDER BY H.ID;



----- OTHER TABLE
CREATE TABLE SO18(
    ID_SO NUMBER PRIMARY KEY,
    NOMBRE NVARCHAR2(100),
    FECHA_CRE DATE
);
DROP TABLE SO18;

INSERT INTO SO18 VALUES ( 1, 'Android', '01/01/2000');
INSERT INTO SO18 VALUES ( 2, 'Ios', '01/01/2001');
SELECT * FROM SO18;

CREATE TABLE MARCA18(
    ID_MARCA NUMBER PRIMARY KEY,
    NOMBRE NVARCHAR2(100),
    PAIS NVARCHAR2(100),
    SLOGAN NVARCHAR2(100)
);

INSERT INTO MARCA18 VALUES (1,'Motorola','Usa','Economico y bueno');
INSERT INTO MARCA18 VALUES (2,'Samsumg','Korea','Bonitos');
INSERT INTO MARCA18 VALUES (3,'Xiaomi','China','Con las 3 B');
INSERT INTO MARCA18 VALUES (4,'Iphone','Usa','Carisimos por cierto');
SELECT * FROM MARCA18;

CREATE TABLE CELULAR18(
    ID_CELULAR NUMBER PRIMARY KEY,
    MODELO NVARCHAR2(100),
    MARCA_ID NUMBER,
    PRECIO NUMBER,
    SO_ID NUMBER,
    RAM NUMBER,
    CONSTRAINT FK_MARCA_CELULAR18 FOREIGN KEY(MARCA_ID) REFERENCES MARCA18(ID_MARCA),
    FOREIGN KEY(SO_ID) REFERENCES SO18(ID_SO)
);
drop table CELULAR18;

INSERT INTO CELULAR18 VALUES(1,'Moto g12 plus',1,9000,1,6);
INSERT INTO CELULAR18 VALUES(2,'Oppo e3',3,8500,1,8);
INSERT INTO CELULAR18 VALUES(3,'Iphone 13 pro max',4,4200,2,4);
INSERT INTO CELULAR18 VALUES(4,'Galaxy s22',2,30000,1,8);
INSERT INTO CELULAR18 VALUES(5,'Iphone x',4,15000,2,4);
INSERT INTO CELULAR18 VALUES(6,'Galaxy a53',2,9000,1,8);
SELECT * FROM celular18;



--1 MOSTRAR LOS CELULARES CON SU MARCA Y SO(INNER)
SELECT C.*, M.NOMBRE MARCA, S.NOMBRE SO
FROM CELULAR18 C
INNER JOIN MARCA18 M
ON M.ID_MARCA = C.MARCA_ID
INNER JOIN SO18 S
ON S.ID_SO = C.SO_ID;

--2 CONTAR CUANTOS TELEFONOS TENEMOS DE CADA MARCA
SELECT COUNT(M.ID_MARCA), M.NOMBRE AS MARCA
FROM CELULAR18 C
INNER JOIN MARCA18 M
ON M.ID_MARCA = C.MARCA_ID 
GROUP BY M.NOMBRE;

--3 BUSCAR LOS CELULARES QUE SU MARCA TENGA UNA m o una M
SELECT C.*, M.NOMBRE MARCA, S.NOMBRE SO
FROM CELULAR18 C
INNER JOIN MARCA18 M
ON M.ID_MARCA = C.MARCA_ID
INNER JOIN SO18 S
ON S.ID_SO = C.SO_ID
WHERE M.NOMBRE LIKE '%M%' OR M.NOMBRE LIKE '%m%';

--4 sacar el promedio de precios de los celulares que tegan 8 de ram
SELECT AVG(PRECIO) PRECIO_PROMEDIO
FROM CELULAR18 C
WHERE C.RAM = 8;

--5 buscar el telefono más caro
SELECT C.*, M.NOMBRE MARCA, S.NOMBRE SO
FROM CELULAR18 C
INNER JOIN MARCA18 M
ON M.ID_MARCA = C.MARCA_ID
INNER JOIN SO18 S
ON S.ID_SO = C.SO_ID
WHERE PRECIO = (SELECT MAX(PRECIO) FROM CELULAR18);


----- TABLE SERIES
-- SERIES -> ID_SERIE, NOMBRE, GENERO_ID, CAPITULOS, PAIS_ID, FECHA_REG, COSTO, PLATAFORMA
-- GENERO -> ID_GENERO, NOMBRE, EDAD_INI, EDAD_FIN
-- PAIS -> ID_PAIS, NOMBRE, CONTINENTE

CREATE TABLE PAIS18S(
    ID_PAIS NUMBER PRIMARY KEY,
    NOMBRE NVARCHAR2(100),
    CONTINENTE NUMBER -- 1 AMERICA, 2 ASIA, 3 OCEANIA, 4 EUROPA, 5 AFRICA
);
INSERT INTO PAIS18S VALUES (1,'Méx',1);
INSERT INTO PAIS18S VALUES (2,'Ale',4);
INSERT INTO PAIS18S VALUES (3,'Usa',1);
INSERT INTO PAIS18S VALUES (4,'Korea',2);
INSERT INTO PAIS18S VALUES (5,'Sudamerica',1);
INSERT INTO PAIS18S VALUES (6,'España',4);
SELECT * FROM PAIS18S;


CREATE TABLE GENERO18S(
    ID_GENERO NUMBER PRIMARY KEY,
    NOMBRE NVARCHAR2(100),
    EDAD_INI NUMBER,
    EDAD_FIN NUMBER
);
INSERT INTO GENERO18S VALUES (1,'Drama',3,80);
INSERT INTO GENERO18S VALUES (2,'Ciencia ficción',53,80);
INSERT INTO GENERO18S VALUES (3,'Terror',18,80);
INSERT INTO GENERO18S VALUES (4,'Romance',18,80);
INSERT INTO GENERO18S VALUES (5,'Acción',15,80);
INSERT INTO GENERO18S VALUES (6,'Infantil',1,80);

SELECT * FROM GENERO18S;


CREATE TABLE SERIE18(
    ID_SERIE NUMBER PRIMARY KEY,
    NOMBRE NVARCHAR2(100),
    GENERO_ID NUMBER,
    CAPITULOS NUMBER,
    PAIS_ID NUMBER,
    FECHA_REG DATE,
    COSTO NUMBER,
    PLATAFORMA NUMBER, -- 1 NETFLLIX, 2 HBO, 3 DISNEY PLUS, 4 TV, 5 AMAZON PRIME, 6 OTROS
    CONSTRAINT FK_GENERO_SERIE18 FOREIGN KEY (GENERO_ID) REFERENCES GENERO18S(ID_GENERO),
    FOREIGN KEY (PAIS_ID) REFERENCES PAIS18S(ID_PAIS)
);
DELETE FROM SERIE18;

INSERT INTO SERIE18 VALUES(1,'Stranger things',2,38,3,'01/01/2015',100000,1);
INSERT INTO SERIE18 VALUES(2,'The expanse',2,40,3,'01/01/2015',150000,1);
INSERT INTO SERIE18 VALUES(3,'Grey´s Anatomy',4,220,3,'01/01/2012',80000,3);
INSERT INTO SERIE18 VALUES(4,'La ley y el Orden',5,250,3,'01/01/2005',90000,5);
INSERT INTO SERIE18 VALUES(5,'Breadking bad',1,70,3,'01/01/2013',150000,1);
INSERT INTO SERIE18 VALUES(6,'Dark',2,30,3,'01/01/2018',200000,2);
SELECT * FROM SERIE18;




-- TRABAJADOR18 -> ID_TRABAJADOR, NOMBRE, APP, EDAD, DEPARTAMENTO_ID, SUELDO, ROL_ID, MODALIDAD_ID, OFICINA_ID

CREATE TABLE ACTIVIDAD18(
    ID_ACTIVIDAD NUMBER PRIMARY KEY,
    NOMBRE VARCHAR(100),
    TIEMPO VARCHAR(100)
);

INSERT INTO ACTIVIDAD18 VALUES(1,'JACOBO','10');
INSERT INTO ACTIVIDAD18 VALUES(2,'JOSE','20');
INSERT INTO ACTIVIDAD18 VALUES(3,'JUAN','30');
INSERT INTO ACTIVIDAD18 VALUES(4,'ALINE','40');
INSERT INTO ACTIVIDAD18 VALUES(5,'LORENA','50');

SELECT* FROM ACTIVIDAD18;


CREATE TABLE DEPARTAMENTO18 (
    ID_DEPARTAMENTO18 NUMBER PRIMARY KEY,
    NOMBRE NVARCHAR2(100),
    ESTATUS NVARCHAR2(100)
);

INSERT INTO DEPARTAMENTO18 VALUES(1, 'RH', 'Activo');
INSERT INTO DEPARTAMENTO18 VALUES(2, 'Mantto', 'Inactivo');
INSERT INTO DEPARTAMENTO18 VALUES(3, 'Calidad', 'Inactivo');
INSERT INTO DEPARTAMENTO18 VALUES(4, 'Sistemas', 'Activo');
INSERT INTO DEPARTAMENTO18 VALUES(5, 'Compras', 'Activo');

SELECT * FROM DEPARTAMENTO18;

CREATE TABLE MODALIDAD18(
    ID_MODALIDAD NUMBER PRIMARY KEY,
    NOMBRE NVARCHAR2(100),
    ESTATUS NVARCHAR2(100)
);

INSERT INTO MODALIDAD18 VALUES(1,'Juan','Activo');
INSERT INTO MODALIDAD18 VALUES(2,'Pedro','Inactivo');
INSERT INTO MODALIDAD18 VALUES(3,'Ricardo','Activo');
INSERT INTO MODALIDAD18 VALUES(4,'Tamara','Suspendidad');
INSERT INTO MODALIDAD18 VALUES(5,'Lizeth','Activa');

SELECT*FROM MODALIDAD18 ORDER BY ID_MODALIDAD;

CREATE TABLE ROL18(
    ID_ROL NUMBER PRIMARY KEY,
    NOMBRE NVARCHAR2(100),
    ESTATUS NUMBER
);

INSERT INTO ROL18 VALUES(1,'Coordinador',1);
INSERT INTO ROL18 VALUES(2,'Evaluador',0);
INSERT INTO ROL18 VALUES(3,'Lider',1);
INSERT INTO ROL18 VALUES(4,'Implementador',1);
INSERT INTO ROL18 VALUES(5,'Especialista',0);
SELECT * FROM ROL18;

-- OFICINA -> ID_OFICINA, NOMBRE, DIRECCION, TELEFONO, ESTATUS -> JESUS
CREATE TABLE OFICINAS18(
    ID_OFICINA NUMBER PRIMARY KEY,
    NOMBRE NVARCHAR2(100),
    DIRECCION NVARCHAR2(100),
    TELEFONO NVARCHAR2(15),
    ESTATUS NUMBER -- 0 disponible, 1 ocupado, 2 en remodelacion
);

INSERT INTO OFICINAS18 VALUES (1, 'ADO','Calle 15 norte, La purisima 4590 Tehuacan puebla','2236734902',1);
INSERT INTO OFICINAS18 VALUES (2, 'Juarez','Calle 13 de septiembre, Los pinos 3490 Puebla Puebla','2212094902',0);
INSERT INTO OFICINAS18 VALUES (3, 'ADS','Calle 15 norte, La purisima 4590 Tehuacan puebla','2236721567',1);
INSERT INTO OFICINAS18 VALUES (4, 'Asus','Av. de los Insurgentes, San José Insurgentes, CDMX','8723456789',1);
INSERT INTO OFICINAS18 VALUES (5, 'Apple','Apple Park','2227623980',2);

SELECT * FROM OFICINAS18;



CREATE TABLE TRABAJADORES18(
    ID_TRABAJADOR NUMBER PRIMARY KEY,
    MATRICULA NVARCHAR2(100) UNIQUE,
    NOMBRE NVARCHAR2(100),
    APP NVARCHAR2(100),
    EDAD NUMBER,
    DEPARTAMENTO_ID NUMBER,
    SUELDO NUMBER,
    MODALIDAD_ID NUMBER,
    OFICINA_ID NUMBER,
    ACTIVIDAD_ID NUMBER,
    CONSTRAINT FK_TRABAJADOR_DEPARTAMENTO18 FOREIGN KEY(DEPARTAMENTO_ID) REFERENCES DEPARTAMENTO18(ID_DEPARTAMENTO18),
    CONSTRAINT FK_TRABAJDOR_MODALIDAD18 FOREIGN KEY (MODALIDAD_ID) REFERENCES MODALIDAD18(ID_MODALIDAD),
    FOREIGN KEY (OFICINA_ID) REFERENCES OFICINAS18(ID_OFICINA),
    FOREIGN KEY (ACTIVIDAD_ID) REFERENCES ACTIVIDAD18(ID_ACTIVIDAD)
);


INSERT INTO TRABAJADORES18 VALUES (1,'Mat-01','Gerardo','Rosas',33,1,28000,1,1,1);
INSERT INTO TRABAJADORES18 VALUES (2,'Pro-01','Jesus','Villegas',24,2,35000,2,3,4);
INSERT INTO TRABAJADORES18 VALUES (3,'Pro-02','Joé Maria','De los Santos',24,3,25000,5,3,2);
INSERT INTO TRABAJADORES18 VALUES (4,'Mat-02','Marisol','Venegas',23,5,27000,1,3,5);
INSERT INTO TRABAJADORES18 VALUES (5,'Pro-03','Kasandra','Tenorio',26,3,30000,4,3,5);
INSERT INTO TRABAJADORES18 VALUES (6,'Mat-055','Alejandro Javier','Sorbo',36,2,29000,4,5,1);
SELECT * FROM TRABAJADORES18;


--1 Obtener los datos de los empleados con sus inner join->departamento, modalidad, oficina 
-- y actividad asi como su case when de estatgus oficina
SELECT 
    T.ID_TRABAJADOR,
    T.MATRICULA,
    T.NOMBRE,
    T.APP,
    T.EDAD,
    T.SUELDO,
    D.NOMBRE DEPARTAMENTO,
    M.NOMBRE MODALIDAD,
    O.NOMBRE OFICINA,
    (  -- 0 disponible, 1 ocupado, 2 en remodelacion
        CASE O.ESTATUS
        WHEN 0 THEN 'Disponible'
        WHEN 1 THEN 'Ocupado'
        WHEN 2 THEN 'En remodelación'
        ELSE '--' END
    ) STATUS_OFICINA,
    A.NOMBRE ACTIVIDAD
FROM TRABAJADORES18 T
INNER JOIN DEPARTAMENTO18 D
ON D.ID_DEPARTAMENTO18 = T.DEPARTAMENTO_ID
INNER JOIN MODALIDAD18 M
ON M.ID_MODALIDAD = T.MODALIDAD_ID
INNER JOIN OFICINAS18 O
ON O.ID_OFICINA = T.OFICINA_ID
INNER JOIN ACTIVIDAD18 A
ON A.ID_ACTIVIDAD = T.ACTIVIDAD_ID;


--2 Contar cuantos empleados tengo de cada modalidad
SELECT 
    COUNT(T.ID_TRABAJADOR) NUM_TRABAJADORES, 
    M.NOMBRE MODALIDAD
FROM TRABAJADORES18 T
INNER JOIN MODALIDAD18 M
ON M.ID_MODALIDAD = T.MODALIDAD_ID group by M.NOMBRE;

--3 Buscar los empleados que su matricula sea mat
SELECT 
    ID_TRABAJADOR ,
    MATRICULA ,
    NOMBRE ,
    APP ,
    EDAD ,
    DEPARTAMENTO_ID ,
    SUELDO ,
    MODALIDAD_ID ,
    OFICINA_ID ,
    ACTIVIDAD_ID 
FROM TRABAJADORES18
WHERE MATRICULA LIKE 'Mat%';

--4 buscar el emplado mas joven
SELECT *
FROM TRABAJADORES18 T
WHERE T.EDAD = (SELECT MIN(EDAD) FROM TRABAJADORES18);

--5 buscar el empleado que gana más
SELECT *
FROM TRABAJADORES18
WHERE SUELDO = (SELECT MAX(SUELDO) FROM TRABAJADORES18)












